/* CodeMirror-RevisedSearch, CodeMirror-AdvancedDialog by Jamie Morris
   MIT License
   Modified
 */

import colors from '../config/colors.js'

export default {
  revised_search:
    '"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"==("undefined"==typeof module?"undefined":_typeof(module))?e(require("codemirror"),require("codemirror-advanceddialog")):"function"==typeof define&&define.amd?define(["codemirror","codemirror-advanceddialog"],e):e(CodeMirror)}(function(a){function n(){this.posFrom=this.posTo=this.lastQuery=this.query=null,this.overlay=null}function c(e){return e.state.search||(e.state.search=new n)}function i(e){return"string"==typeof e&&e==e.toLowerCase()}function s(e,n,o){return e.getSearchCursor(m(n),o,i(n))}function f(e){return e.replace(/\\\\(.)/g,function(e,n){return"n"==n?"\\n":"r"==n?"\\r":n})}function l(e,n,o){var r,t;o&&""!==o&&(n.queryText=o,n.query=m(o),e.removeOverlay(n.overlay,i(n.query)),n.overlay=(r=n.query,t=i(n.query),"string"==typeof r?r=new RegExp(r.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g,"\\\\$&"),t?"gi":"g"):r.global||(r=new RegExp(r.source,r.ignoreCase?"gi":"g")),{token:function(e){r.lastIndex=e.pos;var n=r.exec(e.string);if(n&&n.index==e.pos)return e.pos+=n[0].length||1,"searching";n?e.pos=n.index:e.skipToEnd()}}),e.addOverlay(n.overlay),e.showMatchesOnScrollbar&&(n.annotate&&(n.annotate.clear(),n.annotate=null),n.annotate=e.showMatchesOnScrollbar(n.query,i(n.query))))}function d(e,n,o,r){var t=c(e);n!=t.queryText&&(l(e,t,n),t.posFrom=t.posTo=e.getCursor()),!r&&void 0!==r||u(e,o||!1),x(e)}function p(n){n.operation(function(){var e=c(n);e.lastQuery=e.query,e.query&&(e.query=e.queryText=null,n.removeOverlay(e.overlay),e.annotate&&(e.annotate.clear(),e.annotate=null))})}function y(e,n){n.annotate&&(n.annotate.clear(),n.annotate=null),p(e)}function v(r){return function e(n,o){"readOnly"===o&&n.getOption("readOnly")&&(r(),n.off("optionChange",e))}}function g(r,e,n){var o={value:e=e||"",focus:!0,selectValueOnOpen:!0,closeOnEnter:!1,closeOnBlur:!1,callback:function(e,n){var o=e[0].value;o&&d(r,o,!!n.shiftKey)},onInput:function(e,n){var o=e[0].value;if(!o)return C(r),void p(r);d(r,o,!!n.shiftKey,!1)}};return n&&(o.callback=n),o}function h(o){return{callback:function(e){var n=e[0].value;n&&d(o,n,!0)}}}function b(o){return{callback:function(e){var n=e[0].value;n&&d(o,n,!1)}}}var m=function(e){if(e.exec)return e;if(0===e.indexOf("/")&&0<e.lastIndexOf("/"))try{var n=e.match(/^\\/(.*)\\/([a-z]*)$/);e=new RegExp(n[1],-1==n[2].indexOf("i")?"":"i")}catch(e){}else e=f(e);return("string"==typeof e?""==e:e.test(""))&&(e=/x^/),e},u=function(o,r,t){o.operation(function(){var e=c(o),n=s(o,e.query,r?e.posFrom:e.posTo);(n.find(r)||(n=s(o,e.query,r?a.Pos(o.lastLine()):a.Pos(o.firstLine(),0))).find(r))&&(o.setSelection(n.from(),n.to()),o.scrollIntoView({from:n.from(),to:n.to()},20),e.posFrom=n.from(),e.posTo=n.to(),t&&t(n.from(),n.to()))})},x=function(e){var n=c(e),o=e.getDoc().getValue(),r=void 0,t=n.queryText;if(t&&""!==t){for(;"\\\\"===t.charAt(t.length-1);)t=t.substring(0,t.lastIndexOf("\\\\"));r="string"==typeof n.query?new RegExp(t,"ig"):new RegExp(n.query.source,n.query.flags+"g");var a=o.match(r),i=a?a.length:0,l=1===i?"1 match found.":i+" matches found.";e.getWrapperElement().parentNode.querySelector(".CodeMirror-search-count").innerHTML=l}else C(e)},C=function(e){e.getWrapperElement().parentNode.querySelector(".CodeMirror-search-count").innerHTML=""},q={callback:null};a.commands.find=function(e){var n,o,r;e.getOption("readOnly")||(p(e),n=c(e),o=e.getSelection()||c(e).lastQuery,r=e.openAdvancedDialog(\'\\n    <div class="row find">\\n      <label for="CodeMirror-find-field">Find:</label>\\n      <input id="CodeMirror-find-field" type="text" class="CodeMirror-search-field" placeholder="Find" />\\n      <span class="CodeMirror-search-count"></span>\\n    </div>\\n    <div class="buttons">\\n      <button>Find Previous</button>\\n      <button>Find Next</button>\\n      <button>Close</button>\\n    </div>\\n  \',{shrinkEditor:!0,inputBehaviours:[g(e,o)],buttonBehaviours:[h(e),b(e),q],onClose:function(){y(e,n)}}),e.on("optionChange",v(r)),l(e,n,o),x(e))},a.commands.replace=function(u,e){var n,o,r,t;u.getOption("readOnly")||(p(u),n=function(e){var n,o,r,t,a,i,l=m(e[0].value),c=f(e[1].value);l&&(r=c,t=s(n=u,o=l,n.getCursor("from")),a=t.from(),!(i=t.findNext())&&(t=s(n,o),!(i=t.findNext())||a&&t.from().line===a.line&&t.from().ch===a.ch)||(n.setSelection(t.from(),t.to()),n.scrollIntoView({from:t.from(),to:t.to()}),t.replace("string"==typeof o?r:r.replace(/\\$(\\d)/g,function(e,n){return i[n]}))),d(u,l))},o=c(u),r=u.getSelection()||o.lastQuery,t=u.openAdvancedDialog(\'\\n    <div class="row find">\\n      <label for="CodeMirror-find-field">Replace:</label>\\n      <input id="CodeMirror-find-field" type="text" class="CodeMirror-search-field" placeholder="Find" />\\n     <span class="CodeMirror-search-count"></span>\\n    </div>\\n    <div class="row replace">\\n      <label for="CodeMirror-replace-field">With:</label>\\n      <input id="CodeMirror-replace-field" type="text" class="CodeMirror-search-field" placeholder="Replace" />\\n    </div>\\n    <div class="buttons">\\n      <button>Find Previous</button>\\n      <button>Find Next</button>\\n      <button>Replace</button>\\n      <button>Replace All</button>\\n      <button>Close</button>\\n    </div>\\n  \',{shrinkEditor:!0,inputBehaviours:[g(u,r,function(e){e[1].focus(),e[1].select()}),{closeOnEnter:!1,closeOnBlur:!0,callback:n}],buttonBehaviours:[h(u),b(u),{callback:n},{callback:function(e){var n,r,t,o=m(e[0].value),a=f(e[1].value);o&&(r=o,t=a,(n=u).operation(function(){for(var o,e=s(n,r);e.findNext();){"string"!=typeof r?(o=n.getRange(e.from(),e.to()).match(r),e.replace(t.replace(/\\$(\\d)/g,function(e,n){return o[n]}))):e.replace(t)}}))}},q],onClose:function(){y(u,o)}}),u.on("optionChange",v(t)),l(u,o,r),x(u))}});',
  advanced_dialog:
    '"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"==("undefined"==typeof module?"undefined":_typeof(module))?e(require("codemirror")):"function"==typeof define&&define.amd?define(["codemirror"],e):e(CodeMirror)}(function(s){function f(e){var n=e.state.advancedDialog;n&&n.current&&(n.current.panel.clear(),n.current.onClose&&n.current.onClose(n.current.panel.node),delete n.current,e.focus())}s.defineExtension("openAdvancedDialog",function(e,t){var a=this;if(!this.addPanel)throw"CodeMirror-AdvancedDialog requires the panel addon to be included in the page.  This can usually be found in the addons folder of the default CodeMirror installation, and must be included BEFORE the AdvancedDialog addon.";t=t||{},this.state.advancedDialog||(this.state.advancedDialog={}),this.state.advancedDialog.current&&f(this);var n,o,i,r,u=(n=this,o=e,i=t.bottom,(r=document.createElement("div")).className="CodeMirror-advanced-dialog","string"==typeof o?r.innerHTML=o:r.appendChild(o),n.addPanel(r,{position:i?"bottom":"top"}));this.state.advancedDialog.current={panel:u,onClose:t.onClose};var d=u.node.getElementsByTagName("input"),c=u.node.getElementsByTagName("button");if(d&&0<d.length&&t.inputBehaviours)for(var l=0;l<t.inputBehaviours.length;l++)!function(e){var n=t.inputBehaviours[e],o=d[e];n.value&&(o.value=n.value),n.focus&&o.focus(),n.selectValueOnOpen&&o.select(),n.onInput&&s.on(o,"input",function(e){n.onInput(d,e)}),n.onKeyUp&&s.on(o,"keyup",function(e){n.onKeyUp(d,e)}),s.on(o,"keydown",function(e){n.onKeyDown&&n.onKeyDown(d,e)||(27===e.keyCode||n.closeOnEnter&&13===e.keyCode?(o.blur(),s.e_stop(e),f(a)):13===e.keyCode&&n.callback&&n.callback(d,e))}),!1!==n.closeOnBlur&&s.on(o,"blur",function(){f(a)})}(l);if(c&&0<c.length&&t.buttonBehaviours)for(l=0;l<t.buttonBehaviours.length;l++)!function(e){var n=t.buttonBehaviours[e];n.callback?s.on(c[e],"click",function(e){n.callback(d,e)}):s.on(c[e],"click",function(){f(a)})}(l);return function(){f(a)}})});',
  advanced_dialog_css: `.CodeMirror-advanced-dialog{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif;display:flex;flex-wrap:wrap;align-items:center;background:inherit;padding:10px;overflow:hidden;color:inherit;border:1px solid #eee;position:relative;z-index:10}.CodeMirror-advanced-dialog input{border:none;background-color:#eee;width:20em;color:inherit;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;}.CodeMirror-advanced-dialog button{font-size:90%;border:0;border-radius:5px;color:#fff;background-color:${colors.primary};padding:5px 15px;margin:5px;flex:1}.CodeMirror-advanced-dialog .buttons{display:flex;justify-content:space-evenly;flex-wrap:wrap}.CodeMirror-advanced-dialog .row{display:flex;width:100%;align-items:center;margin-bottom:5px}.CodeMirror-advanced-dialog label{flex:0 0 100px}.CodeMirror-advanced-dialog input[type="text"]{display:inline-block;border:none;margin:10px;padding:10px;flex:1 1 auto}.CodeMirror-search-hint{display:block;font-style:italic;flex:0 0 100%}.CodeMirror-search-count{font-size:80%}`
}
